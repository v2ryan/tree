<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>五力自我評估分析報告</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 列印專屬樣式 */
        @media print {
            .no-print { display: none !important; }
            body { background-color: white !important; padding: 0 !important; margin: 0 !important; }
            .report-container { box-shadow: none !important; border: none !important; width: 100% !important; max-width: none !important; padding: 0 !important; }
            .bg-slate-100 { background-color: white !important; }
            .bg-white { background-color: white !important; }
            .bg-slate-50 { background-color: #f8fafc !important; border: 1px solid #e2e8f0 !important; }
            .bg-blue-50 { background-color: #f0f9ff !important; border: 1px solid #bae6fd !important; }
            .print-break-after { page-break-after: always; }
            svg { max-width: 300px !important; margin: 0 auto !important; }
        }

        input[type="radio"]:checked + label {
            background-color: #1d4ed8;
            color: white;
            border-color: #1d4ed8;
            transform: scale(1.05);
        }
        
        .animate-fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .sticky-header {
            position: sticky;
            top: 0;
            background: white;
            z-index: 10;
            padding-bottom: 10px;
            border-bottom: 1px solid #f1f5f9;
        }
    </style>
</head>
<body class="bg-slate-100 min-h-screen font-sans text-slate-900">

    <div id="app" class="max-w-4xl mx-auto px-4 py-8 report-container">
        <!-- 頂部標題（列印時隱藏） -->
        <header class="mb-8 text-center no-print">
            <h1 class="text-3xl font-bold text-blue-900 mb-2 italic tracking-tight">五力自我評估問卷</h1>
            <p class="text-slate-600 font-medium">根據孔毅老師「贏在扭轉力」體系設計</p>
            <div class="mt-6 h-2 bg-slate-200 rounded-full overflow-hidden max-w-md mx-auto">
                <div id="progress-bar" class="h-full bg-blue-600 transition-all duration-500" style="width: 0%"></div>
            </div>
        </header>

        <!-- 主內容區域 -->
        <div id="survey-content" class="bg-white rounded-2xl shadow-xl p-6 md:p-10 mb-8 min-h-[400px]">
            <!-- 動態注入內容 -->
        </div>

        <!-- 導航按鈕（列印時隱藏） -->
        <div id="nav-buttons" class="flex justify-between items-center no-print">
            <button id="prev-btn" class="px-6 py-2 rounded-lg font-medium text-slate-500 hover:bg-slate-200 transition hidden">上一步</button>
            <span id="page-indicator" class="text-slate-400 font-medium"></span>
            <button id="next-btn" class="px-8 py-3 rounded-lg bg-blue-700 text-white font-bold hover:bg-blue-800 shadow-lg transition">下一階段</button>
        </div>
    </div>

    <script>
        const surveyData = [
            { id: 'envision', name: '眼力', english: 'Envision', title: '一、眼力 (Envision) —— 預見未來的能力', questions: ["1. 我能夠清晰地設定個人和職業目標", "2. 我經常反思自己的長期願景", "3. 我能夠看到未來的潛在機會", "4. 我在做決策時會考慮長期影響", "5. 我能夠根據市場趨勢調整計劃", "6. 我經常尋求新的學習機會", "7. 我能夠有效地預測行業變化", "8. 我會在工作中尋求創新", "9. 我能夠制定出實際可行的計劃", "10. 我能夠激勵他人朝著共同的願景前進", "11. 我對未來的計劃有清晰的藍圖", "12. 我能夠有效地分辨重要的資訊", "13. 我能夠從過去的經驗中學習並改進未來的行動", "14. 我會積極參與團隊的長期規劃", "15. 我能夠在工作中體現創造力", "16. 我相信思考的深度能影響結果", "17. 我能夠快速識別問題的根源", "18. 我會不斷更新自己的專業知識", "19. 我能夠保持開放的心態,迎接新觀點", "20. 我能夠清楚地表達我的願景"] },
            { id: 'energize', name: '魅力', english: 'Energize', title: '二、魅力 (Energize) —— 發揮影響力的能力', questions: ["1. 我能夠激勵他入朝著共同的目標努力", "2. 我在團隊中經常充當鼓舞者的角色", "3. 我能夠輕鬆建立良好的人際關係", "4. 我會主動關心同事的需求和感受", "5. 我能夠在工作中創造積極的氛圍", "6. 我經常表達對他人努力的讚賞", "7. 我能夠有效地處理團隊中的衝突", "8. 我能夠激發團隊成員的潛能", "9. 我會主動分享自己的知識和經驗", "10. 我能夠在壓力下保持積極態度", "11. 我相信團隊合作的重要性", "12. 我經常尋求他人的意見和反饋", "13. 我能夠在團隊中建立信任", "14. 我會定期檢討團隊的表現", "15. 我能夠鼓勵團隊成員分享創新想法", "16. 我會主動尋找增強團隊士氣的方法", "17. 我能夠有效地傳達團隊的願景", "18. 我能夠帶動團隊迎接挑戰", "19. 我相信每個人都能為團隊貢獻力量", "20. 我能夠在工作中保持熱情和動力"] },
            { id: 'execute', name: '動力', english: 'Execute', title: '三、動力 (Execute) —— 完成夢想的能力', questions: ["1. 我能夠有效地制定和執行計劃", "2. 我會在工作中保持高效率", "3. 我能夠按時完成任務", "4. 我會定期檢查自己的進度", "5. 我能夠在壓力下保持工作效率", "6. 我能夠準確地識別優先事項", "7. 我會主動尋求反饋以改進工作", "8. 我能夠靈活應對變化的情況", "9. 我經常反思自己的工作表現", "10. 我能夠有效地管理時間和資源", "11. 我能夠在團隊中發揮主動性", "12. 我會持續尋求提高工作效率的方法", "13. 我能夠克服工作中的挑戰", "14. 我會在工作中保持專注", "15. 我能夠按部就班地完成複雜任務", "16. 我能夠簡化工作流程以提高效率", "17. 我會將目標細分為可行步驟", "18. 我能夠在遇到困難時保持韌性", "19. 我會主動參與團隊的執行工作", "20. 我能夠在工作中保持持續的動力"] },
            { id: 'edge', name: '魄力', english: 'Edge', title: '四、魄力 (Edge) —— 勇於下決定的能力', questions: ["1. 我在做決策時能夠考慮風險", "2. 我不怕面對挑戰和困難", "3. 我有能力在壓力下保持冷靜", "4. 我能夠快速適應變化的環境", "5. 我願意接受新任務,甚至在不熟悉的領域中", "6. 我對自己的決策有信心", "7. 我能夠勇敢地表達自己的意見", "8. 我在團隊中能夠發揮領導作用", "9. 我能夠積極面對失敗,並從中學習", "10. 我在面對困難時能夠保持積極態度", "11. 我會主動尋找解決問題的方法", "12. 我能夠在不確定的情況下做出決策", "13. 我對自己的能力有清晰的認識", "14. 我能夠激勵自己超越自身的限制", "15. 我在工作中能夠保持高效能", "16. 我願意承擔風險以達成目標", "17. 我能夠在逆境中找到機會", "18. 我相信自己的直覺並勇敢行動", "19. 我能夠在團隊中推動變革", "20. 我能夠有效地管理時間和資源"] },
            { id: 'ethics', name: '德力', english: 'Ethics', title: '五、德力 (Ethics) —— 贏得信任的能力', questions: ["1. 我能夠堅持自己的道德原則", "2. 我在工作中始終如一地遵循誠信", "3. 我會主動承擔自己的錯誤", "4. 我尊重他人的隱私和權益", "5. 我會為自己的行為負責", "6. 我在決策時考慮社會責任", "7. 我能夠抵抗不道德的誘惑", "8. 我相信誠實是長期成功的基石", "9. 我會在團隊中提倡道德行為", "10. 我能夠面對困難而不妥協於道德", "11. 我經常反思自己的道德選擇", "12. 我願意為他人提供幫助,而不僅僅考慮自己的利益", "13. 我能夠在壓力下保持誠信", "14. 我相信誠信會帶來良好的商業信用", "15. 我能夠清楚地表達自己的價值觀", "16. 我在面對困難時,會選擇正確的道路", "17. 我會在工作中倡導透明度", "18. 我能夠平衡個人利益與他人利益", "19. 我認為誠信是職場成功的關鍵", "20. 我會主動尋求改善道德標準的方法"] }
        ];

        const reportConfig = {
            levels: [
                { range: [20, 59], name: '第一組：慣性沈睡期', focus: '需喚醒：打破舊習慣' },
                { range: [60, 79], name: '第二組：起點依賴期', focus: '需轉型：從知識轉向本事' },
                { range: [80, 99], name: '第三組：拐點突破期', focus: '需深化：從偶爾做到習慣做' },
                { range: [100, 120], name: '第四組：扭轉卓越期', focus: '需影響：從獨善其身到兼善天下' }
            ],
            details: {
                envision: [
                    { diag: '【停止盲從】你習慣依賴標準答案或他人意見，容易人云亦云。你需要開始爭取「思考主導權」。', task: '每天對接收到的一個資訊或新聞，問三次「為什麼？」，直到找出與別人不一樣的觀點。' },
                    { diag: '【啟動左腦】你有知識，但思緒可能混亂或過於發散。你需要訓練「嚴謹思考」，將資訊轉化為邏輯。', task: '每天下班前，用筆紙將今天最重要的一件事「寫下來」，理清它的前因後果。' },
                    { diag: '【操練右腦】你邏輯清晰，但缺乏創新突破。你需要「脫框思維」與「抽象化」能力。', task: '針對一個工作難題，試著畫出一張「關係圖」或歸納出「兩個結論」，強迫自己看見整體脈絡。' },
                    { diag: '【預見未來】你已有洞察力，現在要訓練「直覺」。像頂尖運動員一樣，在行動前先「看見」結果。', task: '在做重大決策或開會前，閉眼 3 分鐘，在腦中像放電影一樣預演整個過程與成功的畫面。' }
                ],
                energize: [
                    { diag: '【情緒防守】你容易受環境影響，情緒起伏大。你需要建立緩衝區，避免被情緒綁架。', task: '當感到生氣或焦慮時，強迫自己數到 10 再開口，或離開現場去喝杯水（走上心靈陽台）。' },
                    { diag: '【有效溝通】你善於做事但較少關注人。你需要從「說服」轉向「傾聽」，建立信任。', task: '每天找一位同事對話 5 分鐘，全程不看手機、不打斷，只專注聽懂他的感受。' },
                    { diag: '【深度連結】你有良好人緣，現在要建立深層關係。透過「一對一」瞭解夥伴的內在需求。', task: '在批評或拒絕別人前，先問自己：「如果我是他，聽到這句話會有什麼感覺？」' },
                    { diag: '【激勵領袖】你是團隊的能量源。你需要用正向信念感染他人，幫助他人成功。', task: '每天真誠地讚美或感謝一位夥伴的具體貢獻，成為他生命中的貴人。' }
                ],
                execute: [
                    { diag: '【打破慣性】你可能有拖延習慣，想法多行動少。你需要克服起步的摩擦力。', task: '挑選一件你最想逃避的小事（如回信、整理桌面），告訴自己「只做 5 分鐘」，然後立刻開始。' },
                    { diag: '【專注聚焦】你很勤奮但效率不高（瞎忙）。你需要學會「減法」，專注於高價值事務。', task: '列出待辦事項，刪掉 20% 不重要的雜事，只專注做完那件最重要的事。' },
                    { diag: '【追求極致】你執行力強，但可能陷入瓶頸。你需要「先深後博」，把專業練到無可取代。', task: '檢視你的工作流程，找出一個小細節進行優化，讓今天比昨天好一點點。' },
                    { diag: '【加乘效應】你已是高手，現在要追求複利效應。透過持續的微小積累創造巨大差異。', task: '建立一個雷打不動的習慣（如每日覆盤），即使狀況不好也堅持執行，保持動能。' }
                ],
                edge: [
                    { diag: '【克服恐懼】你傾向待在舒適圈，害怕改變。你需要練習「與恐懼共存」。', task: '做一件平常不敢做的小事（如主動舉手發言），告訴自己「失敗也沒關係」。' },
                    { diag: '【承擔責任】你按部就班，但在風險面前會猶豫。你需要學習在資訊不足時做決定。', task: '對於生活中的小選擇（吃什麼），規定自己在 30 秒內做決定，不許猶豫。' },
                    { diag: '【逆向思維】你能解決問題，但需要更強的應變力。當環境改變時，敢於推翻舊經驗。', task: '睡前回顧今天遇到的一個挫折，寫下：「這件事帶給我的好處或機會是什麼？」' },
                    { diag: '【扭轉局勢】你是領袖，能在危機中看見轉機。你需要帶領團隊進行「典範轉移」。', task: '每週問自己一次：「如果我現在的成功模式失效了，我該怎麼辦？」並構思一個備案。' }
                ],
                ethics: [
                    { diag: '【建立底線】你可能為了方便而偶爾妥協。你需要建立「誠信是生存底線」的觀念。', task: '對自己許下一個微小的承諾（如準時），並絕對遵守它，不找任何藉口。' },
                    { diag: '【誠實面對】你為人正直，但在犯錯時可能傾向掩飾。你需要展現真實。', task: '當發現自己不懂或做錯時，坦誠地說「我不知道」或「對不起」，而不是試圖辯解。' },
                    { diag: '【利他思維】你有良好操守，現在要實踐「利他是最好的利己」。', task: '每天做一件「分外之事」去幫助同事或家人，且不求回報，單純為了對方的益處。' },
                    { diag: '【影響生命】你是值得信賴的榜樣。你需要用生命影響生命，建立誠信的文化。', task: '在會議或對話中，分享一個關於「誠信」或「價值觀」的故事，影響身邊的人。' }
                ]
            }
        };

        let currentPage = 0;
        const responses = {};

        const surveyContent = document.getElementById('survey-content');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const pageIndicator = document.getElementById('page-indicator');
        const progressBar = document.getElementById('progress-bar');

        function renderPage() {
            if (currentPage < surveyData.length) {
                const category = surveyData[currentPage];
                let html = `
                    <div class="mb-6 animate-fade-in">
                        <h2 class="text-2xl font-black text-blue-900">${category.title}</h2>
                        <p class="text-sm text-slate-500 mt-1 italic uppercase tracking-wider">根據感受評分：6 (最高) - 1 (最低)</p>
                    </div>

                    <div class="sticky-header flex justify-between px-2 mb-4 no-print">
                        <span class="text-xs font-black text-blue-700">6 非常同意</span>
                        <span class="text-xs font-black text-slate-400">1 非常不同意</span>
                    </div>

                    <div class="space-y-6 animate-fade-in">
                `;

                category.questions.forEach((q, idx) => {
                    const qId = `${category.id}_${idx}`;
                    const currentVal = responses[qId] || 0;
                    
                    html += `
                        <div class="border-b border-slate-50 pb-6 px-2">
                            <p class="text-lg text-slate-700 mb-4 font-medium leading-relaxed">${q}</p>
                            <div class="flex flex-row-reverse gap-2 md:gap-4 justify-between">
                                ${[1, 2, 3, 4, 5, 6].map(val => `
                                    <div class="flex-1">
                                        <input type="radio" name="${qId}" id="${qId}_${val}" value="${val}" class="hidden" 
                                            ${currentVal == val ? 'checked' : ''} 
                                            onchange="saveResponse('${qId}', ${val})">
                                        <label for="${qId}_${val}" class="flex flex-col items-center justify-center w-full py-3 border-2 border-slate-200 rounded-xl cursor-pointer hover:border-blue-400 text-slate-600 font-black transition-all">
                                            ${val}
                                        </label>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                });

                html += `</div>`;
                surveyContent.innerHTML = html;
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
                prevBtn.classList.toggle('hidden', currentPage === 0);
                nextBtn.textContent = (currentPage === surveyData.length - 1) ? '查看深度診斷報告' : '下一階段';
                pageIndicator.textContent = `階段 ${currentPage + 1} / ${surveyData.length}`;
                progressBar.style.width = `${((currentPage) / surveyData.length) * 100}%`;
            } else {
                renderResult();
            }
        }

        window.saveResponse = (id, val) => { responses[id] = val; };

        function validateCurrentPage() {
            const category = surveyData[currentPage];
            for (let i = 0; i < category.questions.length; i++) {
                if (!responses[`${category.id}_${i}`]) {
                    showToast(`請完成第 ${i + 1} 題`);
                    return false;
                }
            }
            return true;
        }

        function getLevel(score) {
            return reportConfig.levels.find(l => score >= l.range[0] && score <= l.range[1]);
        }

        function getAdviceDetail(id, score) {
            let idx = 0;
            if (score >= 100) idx = 3;
            else if (score >= 80) idx = 2;
            else if (score >= 60) idx = 1;
            return reportConfig.details[id][idx];
        }

        function renderResult() {
            const scores = surveyData.map(cat => {
                let sum = 0;
                for (let i = 0; i < cat.questions.length; i++) { sum += responses[`${cat.id}_${i}`] || 0; }
                const level = getLevel(sum);
                const advice = getAdviceDetail(cat.id, sum);
                return { id: cat.id, label: cat.name, english: cat.english, value: sum, level, advice };
            });

            const sorted = [...scores].sort((a, b) => a.value - b.value);
            const weakest = sorted[0];
            const strongest = sorted[scores.length - 1];

            let html = `
                <div class="animate-fade-in">
                    <div class="flex flex-col md:flex-row justify-between items-start mb-10 border-b-4 border-blue-900 pb-6">
                        <div>
                            <h2 class="text-4xl font-black text-blue-900 tracking-tighter">五力深度診斷分析報告</h2>
                            <p class="text-slate-500 font-bold mt-1 uppercase tracking-widest text-sm">Turning 5 Forces Analysis Report</p>
                        </div>
                        <div class="mt-6 md:mt-0 no-print">
                            <button onclick="handlePrint()" class="flex items-center px-8 py-4 bg-blue-700 text-white rounded-2xl font-black hover:bg-blue-800 shadow-2xl transition transform active:scale-95">
                                <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"></path></svg>
                                列印 / 存為 PDF 報告
                            </button>
                        </div>
                    </div>

                    <!-- 核心圖表與分數 -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 mb-12 items-center">
                        <div class="space-y-6">
                            ${scores.map(s => `
                                <div class="bg-slate-50 p-5 rounded-2xl border border-slate-200">
                                    <div class="flex justify-between items-end mb-2">
                                        <span class="text-2xl font-black text-slate-800">${s.label}</span>
                                        <div class="text-right">
                                            <span class="text-3xl font-black text-blue-700">${s.value}</span>
                                            <span class="text-slate-400 font-bold text-sm">/ 120</span>
                                        </div>
                                    </div>
                                    <div class="flex items-center gap-4">
                                        <div class="flex-1 bg-slate-200 h-4 rounded-full overflow-hidden">
                                            <div class="bg-blue-600 h-full transition-all duration-1000" style="width: ${(s.value / 120) * 100}%"></div>
                                        </div>
                                        <div class="text-right">
                                            <p class="text-[10px] font-black text-blue-800 uppercase leading-none">${s.level.name.split('：')[1]}</p>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        <div class="flex justify-center">
                            <svg viewBox="0 0 100 100" class="w-full max-w-[320px] overflow-visible">
                                <circle cx="50" cy="50" r="40" fill="none" stroke="#e2e8f0" stroke-width="0.5" stroke-dasharray="2" />
                                <circle cx="50" cy="50" r="20" fill="none" stroke="#e2e8f0" stroke-width="0.5" stroke-dasharray="2" />
                                ${scores.map((s, i) => {
                                    const a = (i * 2 * Math.PI) / 5 - Math.PI/2;
                                    const x = 50 + 40 * Math.cos(a);
                                    const y = 50 + 40 * Math.sin(a);
                                    const lx = 50 + 55 * Math.cos(a);
                                    const ly = 50 + 55 * Math.sin(a);
                                    return `<line x1="50" y1="50" x2="${x}" y2="${y}" stroke="#cbd5e1" stroke-width="0.5" /><text x="${lx}" y="${ly}" text-anchor="middle" class="text-[6px] font-black fill-slate-800">${s.label}</text>`;
                                }).join('')}
                                <polygon points="${scores.map((s, i) => {
                                    const a = (i * 2 * Math.PI) / 5 - Math.PI/2;
                                    const r = (s.value / 120) * 40;
                                    return `${50 + r * Math.cos(a)},${50 + r * Math.sin(a)}`;
                                }).join(' ')}" fill="rgba(29, 78, 216, 0.25)" stroke="#1d4ed8" stroke-width="2" />
                            </svg>
                        </div>
                    </div>

                    <!-- 瓶頸與優勢分析 -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-12">
                        <div class="p-8 border-l-[12px] border-red-600 bg-red-50 rounded-r-3xl">
                            <h4 class="font-black text-red-800 text-xl mb-3 uppercase tracking-tight">最短的木板 (發展瓶頸)</h4>
                            <p class="text-slate-900 font-black text-2xl mb-2">${weakest.label}：${weakest.value} 分</p>
                            <p class="text-slate-600 text-sm leading-relaxed font-medium">這是您目前的發展限制。根據木桶原理，應優先針對此力進行操練，打破慣性突破瓶頸。</p>
                        </div>
                        <div class="p-8 border-l-[12px] border-green-600 bg-green-50 rounded-r-3xl">
                            <h4 class="font-black text-green-800 text-xl mb-3 uppercase tracking-tight">最強的優勢 (天賦所在)</h4>
                            <p class="text-slate-900 font-black text-2xl mb-2">${strongest.label}：${strongest.value} 分</p>
                            <p class="text-slate-600 text-sm leading-relaxed font-medium">這是您的核心競爭力。應利用「區分原則」繼續強化，使其成為不可替代的卓越優勢。</p>
                        </div>
                    </div>

                    <div class="print-break-after"></div>

                    <!-- 深度逐項建議 -->
                    <h3 class="text-3xl font-black text-blue-900 mb-10 border-b-8 border-blue-900 inline-block tracking-tighter">逐項深度診斷與每日一事</h3>
                    <div class="space-y-12">
                        ${scores.map(s => `
                            <div class="bg-white p-8 rounded-3xl border-2 border-slate-100 shadow-sm">
                                <div class="flex flex-col md:flex-row justify-between md:items-center mb-8 gap-4">
                                    <div class="flex items-center gap-4">
                                        <div class="w-12 h-12 bg-blue-900 text-white rounded-2xl flex items-center justify-center font-black text-xl shadow-lg">${s.label.charAt(0)}</div>
                                        <h4 class="text-3xl font-black text-slate-900">${s.label} <span class="text-sm font-bold text-slate-400 uppercase tracking-widest">${s.english}</span></h4>
                                    </div>
                                    <div class="flex flex-col items-end">
                                        <span class="px-6 py-2 bg-blue-900 text-white rounded-full text-xs font-black uppercase tracking-widest shadow-md">${s.level.name}</span>
                                        <p class="text-[10px] text-blue-600 font-black mt-2 uppercase tracking-tighter">${s.level.focus}</p>
                                    </div>
                                </div>
                                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                                    <div class="bg-slate-50 p-6 rounded-2xl border border-slate-200">
                                        <div class="flex items-center gap-2 mb-4">
                                            <span class="px-2 py-0.5 bg-slate-800 text-white text-[10px] font-black rounded uppercase">診斷提議</span>
                                        </div>
                                        <p class="text-slate-700 text-base leading-relaxed font-medium">${s.advice.diag}</p>
                                    </div>
                                    <div class="bg-blue-50 p-6 rounded-2xl border border-blue-200">
                                        <div class="flex items-center gap-2 mb-4">
                                            <span class="px-2 py-0.5 bg-blue-700 text-white text-[10px] font-black rounded uppercase">每日一事</span>
                                        </div>
                                        <p class="text-blue-900 text-base leading-relaxed font-black">${s.advice.task}</p>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>

                    <div class="mt-16 pt-10 border-t-2 border-slate-200 text-center no-print">
                        <p class="text-slate-400 text-sm font-bold">這份報告旨在「診斷」與「處方」。持續操練，才能完成從知識到本事的轉化。</p>
                        <button onclick="window.location.reload()" class="mt-8 px-12 py-4 border-4 border-blue-900 text-blue-900 rounded-2xl hover:bg-blue-900 hover:text-white transition font-black text-lg shadow-xl">重新開始深度評估</button>
                    </div>
                </div>
            `;

            surveyContent.innerHTML = html;
            prevBtn.classList.add('hidden');
            nextBtn.classList.add('hidden');
            pageIndicator.textContent = "分析完畢";
            progressBar.style.width = "100%";
        }

        function handlePrint() {
            setTimeout(() => { window.print(); }, 150);
        }

        function showToast(msg) {
            const toast = document.createElement('div');
            toast.className = "fixed top-10 left-1/2 -translate-x-1/2 bg-red-600 text-white px-10 py-5 rounded-3xl shadow-2xl z-50 animate-bounce font-black text-lg";
            toast.textContent = msg;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 2500);
        }

        nextBtn.addEventListener('click', () => {
            if (validateCurrentPage()) {
                currentPage++;
                renderPage();
            }
        });

        prevBtn.addEventListener('click', () => {
            if (currentPage > 0) {
                currentPage--;
                renderPage();
            }
        });

        renderPage();
    </script>
</body>
</html>
